---
layout: single
title: "Wan2.1 Review"
categories: Study-concept
tag: [Wan2.1, Diffusion , Video Diffusion, Text to Video, Image to Video, DiT, Alibaba]
toc: true
author_profile: false
sidebar:
    nav: "docs"
search: true
typora-root-url: ../
---





# 0. Introduction

ğŸ‘‰ğŸ»[Wan2.1 GitHub link](https://github.com/Wan-Video/Wan2.1)

ğŸ‘‰ğŸ»[Wan2.1 model link](https://huggingface.co/Wan-AI/Wan2.1-T2V-14B)

ğŸ‘‰ğŸ»[Wan2.1 technical report link](https://arxiv.org/pdf/2503.20314)

ğŸ‘‰ğŸ»[Wan2.1 blog link](https://wan.video/welcome?spm=a2ty_o02.30011076.0.0.6c9ee41eCcluqg)

ğŸ‘‰ğŸ»[Wan2.1 playground link](https://wan.video/)



*"í…ìŠ¤íŠ¸ í•œ ì¤„, í•œ ì¥ì˜ ì´ë¯¸ì§€ë§Œìœ¼ë¡œë„ ì˜í™” ê°™ì€ 5 ì´ˆì§œë¦¬ ì˜ìƒì„ ë§Œë“œëŠ” ì‹œëŒ€."* â€” ì•Œë¦¬ë°”ë°” **Tongyi Lab**ì˜ **Wan 2.1**ì€ 2025ë…„ 2ì›” ê³µê°œëœ ìµœì´ˆì˜ **ì™„ì „ ì˜¤í”ˆì†ŒìŠ¤ SOTA ë¹„ë””ì˜¤ ìƒì„± ëª¨ë¸**ì´ë‹¤. í…ìŠ¤íŠ¸â€‘íˆ¬â€‘ë¹„ë””ì˜¤(T2V) ë° ì´ë¯¸ì§€â€‘íˆ¬â€‘ë¹„ë””ì˜¤(I2V)ëŠ” ë¬¼ë¡ , ë¹„ë””ì˜¤ í¸ì§‘ê³¼ ì˜¤ë””ì˜¤ í•©ì„±ê¹Œì§€ ì§€ì›í•œë‹¤. ë³¸ ê¸€ì—ì„œëŠ” Wan 2.1ì˜ **ì•„í‚¤í…ì²˜, í•™ìŠµ ë°©ë²•, ë°ì´í„°ì…‹, í•˜ì´í¼íŒŒë¼ë¯¸í„°**ë¥¼ ë…¼ë¬¸ ìˆ˜ì¤€ìœ¼ë¡œ í•´ë¶€í•˜ê³ , **Video Diffusion**ì˜ ë¯¸ë˜ë¥¼ ì¡°ë§í•œë‹¤.



### ì£¼ìš” íŠ¹ì§•

Wan 2.1ì€ ê³µê°œ ì´í›„ **"ì˜¤í”ˆì†ŒìŠ¤ SORA"**ë¼ ë¶ˆë¦¬ë©° ì»¤ë®¤ë‹ˆí‹°ì˜ ëœ¨ê±°ìš´ ê´€ì‹¬ì„ ë°›ì•˜ë‹¤. í•µì‹¬ í‚¤ì›Œë“œëŠ” **3D Causal VAE + Diffusion Transformer + Flow Matching + ëŒ€ê·œëª¨ ë°ì´í„°ì…‹**. íŠ¹íˆ ë‹¤êµ­ì–´ T2Vì—ì„œ **ì˜ìƒ ë‚´ë¶€ í…ìŠ¤íŠ¸**ê¹Œì§€ ì •í™•íˆ í•©ì„± ê°€ëŠ¥í•œ ì²« ëª¨ë¸ì´ë¼ëŠ” ì ì´ ì¸ìƒì ì´ë‹¤.

- **3D Causal VAE â€”** ì‹œê°„ ì¸ê³¼ì„±ì„ ë³´ì¡´í•˜ë©´ì„œ 64x ì••ì¶•.
- **Flow Matching â€”** ë…¸ì´ì¦ˆ ì œê±°ë¥¼ ì—°ì† í™•ë¥  íë¦„ìœ¼ë¡œ í‘œí˜„í•´ ì•ˆì • ë° ê°€ì†.
- **15 B Video + 10 B Image â€”** ì‹œê°â€‘í…ìŠ¤íŠ¸ ì •í•© & í•˜ë“œ ì¼€ì´ìŠ¤ í•™ìŠµ.
- **6â€‘ë‹¨ê³„ Curriculum â€”** í•´ìƒë„, ë³µì¡ë„ë¥¼ ì ì§„ì ìœ¼ë¡œ ìƒìŠ¹.
- **VBench 0.724 â€”** Sora(0.700), Genâ€‘2(0.672)ë¥¼ ëŠ¥ê°€.



# 1. Wan2.1 Model Architecture



## 1-1. Overview

| Items                     | 14 B (720p)             | 14 B (480p) | 1.3 B (480p) |
| ------------------------- | ----------------------- | ----------- | ------------ |
| **Parameter Size**        | â‰ˆ 14.0 B                | â‰ˆ 14.0 B    | â‰ˆ 1.3 B      |
| **Resolution**            | 1280x720                | 960x540     | 960x540      |
| **Frame**                 | 80 (5 s@16 fps)         | 80          | 80           |
| **DiT Layers/Embeddings** | 40 / 5120               | 40 / 5120   | 30 / 1536    |
| **VAE down samples**      | 8x spatial, 4x temporal | ë™ì¼        | ë™ì¼         |
| **Data**                  | 15 B video + 10 B image | ë™ì¼        | ë™ì¼         |
| **Licenxe**               | Apache 2.0              | Apache 2.0  | Apache 2.0   |



ğŸ“Œ *Wan2.1 Architecture*

![Wan2.1-Architecture0](/images/2025-05-07-Wan2dot1/Wan2dot1-Architecture0.jpg){: .align-center}



ğŸ“Œ *Wan2.1 Architecture*

![Wan2.1-Architecture1](/images/2025-05-07-Wan2dot1/Wan2dot1-Architecture1.png){: .align-center}



## 1-2. Details

### Wanâ€‘VAE 

#### ì„¤ê³„ ëª©í‘œ

1. **ì‹œê°„ ì¸ê³¼ì„±** â€” ë¯¸ë˜ í”„ë ˆì„ ì°¸ì¡° ì—†ì´ í˜„ì¬ í”„ë ˆì„ ì¸ì½”ë”©.
2. **ë©”ëª¨ë¦¬ íš¨ìœ¨** â€” ê¸´ ì˜ìƒë„ ë…¸íŠ¸ë¶ GPUì—ì„œ ìŠ¤íŠ¸ë¦¬ë° ê°€ëŠ¥.
3. **ì¬í˜„ í’ˆì§ˆ** â€” PSNR, SSIM â‰¥ ë™ê¸‰ 2D VAE + 1 dB ì´ìƒ.

#### ì¸ì½”ë” êµ¬ì¡°

- ì…ë ¥ : RGB $T=80$ frames, $HxWâˆˆ{720,540}$.
- **Conv3Dâ€‘Causal x 5 ë¸”ë¡** â†’ ì‹œê°„ ì¶• causal padding.
- **Down sample (2x) x 3** â†’ ìµœì¢… 8x spatial ì¶•ì†Œ, 4x temporal ì¶•ì†Œ.
- ì¶œë ¥ : `latent_seq âˆˆ R^{(1+T/4) x (H/8) x (W/8) x C}`.

#### ë””ì½”ë” êµ¬ì¡°

- **ConvTranspose3D ë¸”ë¡** x ëŒ€ì¹­ìœ¼ë¡œ êµ¬ì„±.
- Skip connection : ì¸ì½”ë” ê° ë‹¨ê³„ feature â†’ ëŒ€ì‘ ë””ì½”ë” ë‹¨ê³„.
- ë§ˆì§€ë§‰ ì¸µ : `tanh` â†’ [-1,1] í”½ì…€ ë²”ìœ„.

#### íˆìŠ¤í† ë¦¬ ìºì‹œ & ì²­í¬ ìŠ¤íŠ¸ë¦¬ë°

- **ì²­í¬ í¬ê¸° 4f** â€” ì¸ì½”ë”© ì‹œ ê³¼ê±° latents ìºì‹œì— ì €ì¥.
- **Decoder**ëŠ” ë™ì¼ ì²­í¬ ë‹¨ìœ„ë¡œ ìˆœì°¨ ë³µì› â†’ GPU 2 GB ë©”ëª¨ë¦¬ ì„¸ì´ë¸Œ.



### Diffusion Transformer (DiT) 

#### ë¸”ë¡ êµ¬ì„± & íŒŒë¼ë¯¸í„°

- **Layer = 40 (14 B) / 30 (1.3 B)**.
- **Selfâ€‘Attention** â†’ í† í°ìˆ˜ â‰ˆ (21 latents) x H/8 x W/8 â‰ˆ 13 k.
- **FFN hidden** = 8 x d_model.
- **GEGLU** í™œì„±í™” í•¨ìˆ˜.

#### ì‹œê°„ ì„ë² ë”© âš¡ Adaptive LN

- `t_embed = MLP(sinusoid(t))` (128â€‘d).
- ê° ë¸”ë¡ AdaLN: `y = (1 + s) \cdot (x / \sqrt{Var} + \epsilon) + b`, where `(s,b)` â† Linear(`t_embed`).
- **ê³µìœ  MLP** â†’ íŒŒë¼ë¯¸í„° íš¨ìœ¨, ë‹¨ê³„ë³„ ì¼ê´€ì„±.

#### í¬ë¡œìŠ¤ ì–´í…ì…˜ â†” í…ìŠ¤íŠ¸, ì´ë¯¸ì§€ ì¡°ê±´

- Query = video latents, Key/Value = `concat(text_emb, img_emb)`.
- **Classâ€‘free** ì¡°ê±´ ë¸”ë­í¬ â†’ CFG ë•Œ ì‚¬ìš©.

#### Flow Matching ê°ê´€ì‹ & í•™ìŠµ ì•ˆì •í™”

- íƒ€ê¹ƒ : `\mathbf{F}(x,t) = -\sigma(t)\nabla_x \log p_t(x)`.
- ëª¨ë¸ `\hat{F}_\theta` ë¡œ **ODE integrator**(DDIM) í•´ì„, ìŠ¤í… ìˆ˜ â†“.



### UMT5 í…ìŠ¤íŠ¸ ì¸ì½”ë” 

#### ë‹¤êµ­ì–´ ì‚¬ì „í•™ìŠµ

- 2 T í† í°, 100+ ì–¸ì–´.
- **ìì²´ BPE 100k** â†’ ì¤‘êµ­ì–´, ì˜ì–´ í† í° íš¨ìœ¨ â†‘.

#### í…ìŠ¤íŠ¸â€‘ë¹„ì£¼ì–¼ ë¸Œë¦¿ì§€

- Text [CLS] embedding â†’ DiT global prompt.
- Tokenâ€‘wise crossâ€‘attn â†’ fineâ€‘grained alignment.



### I2V ì´ë¯¸ì§€ ì¡°ê±´ ë¶„ê¸° 

#### CLIP Vision ì¸ì½”ë”

- ViTâ€‘H @ 14 patch, 1280â€‘d.
- Linear â†’ d_model dim, LayerNorm.

#### ì²« í”„ë ˆì„ ì ì¬ ì‚½ì… & ì •í•© ìœ ì§€

- `latent_seq[0] = VAE(img)` ëŒ€ì²´.
- **Noise schedule shift** â†’ ì²« í”„ë ˆì„ ë³µì‚¬ but ë‚˜ë¨¸ì§€ í”„ë ˆì„ì€ ë…¸ì´ì¦ˆ.

### ë¶€ê°€ ëª¨ë“ˆ : ë¹„ë””ì˜¤â€‘íˆ¬â€‘ì˜¤ë””ì˜¤

- Autoâ€‘tag video â†’ Text2Audio LLM (Qwenâ€‘Audio) â†’ WAV.




# 2. Train Methods



## 2-1. ëŒ€ê·œëª¨ ë°ì´í„°ì…‹ íŒŒì´í”„ë¼ì¸

#### 1ì°¨ â€” ê¸°ë³¸ í•„í„°ë§

- **ì¥ë©´ ëŠê¹€**, **ë¸”ë™ ë°”**, **ì›Œí„° ë§ˆí¬** ê²€ì¶œ ëª¨ë¸.
- FPS < 8 or > 60 â†’ ì œê±°.

#### 2ì°¨ â€” ì‹œë§¨í‹± êµ°ì§‘ & í’ˆì§ˆ ìŠ¤ì½”ì–´

- ViT â€‘ B/32 feature â†’ Kâ€‘means 100 í´ëŸ¬ìŠ¤í„°.
- ê° í´ëŸ¬ìŠ¤í„° 500 ìƒ˜í”Œ ì¸ìˆ˜ ì‘ì—… â†’ ì‘ì€ í‰ê°€ ëª¨ë¸.

#### 3ì°¨ â€” ì‹œê°ì  í…ìŠ¤íŠ¸ ê°•í™”

- í•©ì„±: í°íŠ¸ 8k x ë°°ê²½ 3k.
- ì‹¤ì‚¬: panâ€‘OCR â†’ text box IOU > 0.7 ì„ íƒ.

#### 4ì°¨ â€” ê³ í’ˆì§ˆ í›„ì²˜ë¦¬ ì„¸íŠ¸

- PQV (Photo Quality Value) ìƒìœ„ 20 %.
- ë™ì˜ìƒ : Motion Complexity â†‘, Scene Diversity â†‘.



## 2-2. 6ë‹¨ê³„ ì»¤ë¦¬í˜ëŸ¼ í•™ìŠµ

| Step | Resolution | Length | Batch | LR   | Purpose                 |
| ---- | ---------- | ------ | ----- | ---- | ----------------------- |
| 1    | 256Â² img   | â€”      | 32 k  | 1eâ€‘3 | í…ìŠ¤íŠ¸â€‘ì‹œê° ë§¤í•‘ ì´ˆê¸°í™” |
| 2    | 192Â²       | 5 s    | 8 k   | 6eâ€‘4 | ì›€ì§ì„ íŒ¨í„´ ìŠµë“        |
| 3    | 480Â²       | 5 s    | 4 k   | 4eâ€‘4 | ë””í…Œì¼ â†‘                |
| 4    | 720Â²       | 5 s    | 2 k   | 3eâ€‘4 | ê³ í•´ìƒë„ ì ì‘           |
| 5    | 480Â²       | 5 s    | 1 k   | 1eâ€‘4 | ê³ í’ˆì§ˆ FT(480p)         |
| 6    | 720Â²       | 5 s    | 0.5 k | 8eâ€‘5 | ê³ í’ˆì§ˆ FT(720p)         |



## 2-3. ì†ì‹¤ í•¨ìˆ˜ & Guidance

#### Flow Matching Loss

$$
\mathcal{L}_{FM} = \mathbb{E}\left[\left|\hat{F}_\theta(x,t) - F(x,t)\right|_2^2\right]
$$

#### CFG & CFGâ€‘Zero

- Scale 3.5 ~ 7.0.
- CFGâ€‘Zero: ë¬´ì¡°ê±´ ë¶„ê¸° replace â†’ "dropout mask" Î± = 0.1.



## 2-4. ë¶„ì‚° & ë©”ëª¨ë¦¬ ìµœì í™”

#### RingAttention & Ulysses ì‹œí€€ìŠ¤ ë³‘ë ¬

- í† í° ê¸¸ì´ â‰ˆ 13 k â†’ GPU 32 GB ì´ˆê³¼ âš ï¸.
- Query x Key ë¶„í•  â†’ allâ€‘reduce cost â†“ 45 %.

#### Activate Offload & Checkpoint

- GPUâ†”CPU  pipelined swap, step latency +2 % â€¦ VRAM â€‘30 %.

#### ì§€ëŠ¥í˜• ë…¸ë“œ ìŠ¤ì¼€ì¤„ëŸ¬

- Node health ping â†’ slow node 10x ë¯¸ë§Œì‹œ ìë™ ì¶•ì¶œ.



# 3. Hyper-Parameters



## 3-1. Train

| Items               | Values                                  |
| ------------------- | --------------------------------------- |
| **Optimizer**       | *AdamW* (Î²â‚ = 0.9, Î²â‚‚ = 0.95, Îµ = 1eâ€‘8) |
| **LR scheduler**    | Cosine decay w/ 10 % warmâ€‘up            |
| **Base LR**         | 4eâ€‘4 (14B) / 6eâ€‘4 (1.3B)                |
| **Total batch**     | 4 096 (14B) / 8 192 (1.3B)              |
| **Grad accum**      | 8 steps                                 |
| **EMA**             | 0.9995                                  |
| **Diffusion steps** | 50 (ì¶”ë¡ ) / 1 000 (í•™ìŠµ)                |
| **CFG scale**       | 3.5 â€“ 7.0                               |
| **Dropout**         | 0.1 (attn / ffn)                        |



## 3-2. Inference

| Items              | Default Values | Notes               |
| ------------------ | -------------- | ------------------- |
| **Sampling steps** | 50             | DDIM solver         |
| **CFG Scale**      | 5.0            | â‰¥7 : overshoot risk |
| **Seed**           | 42             | ì¬í˜„ì„±              |
| **Output FPS**     | 16             | ë³€ê²½ ê°€ëŠ¥           |



# 4. Evaluation & Comparison



### VBench ì¢…í•© ì ìˆ˜

- Wan 2.1â€‘14B **0.724** > Sora 0.700 > Genâ€‘2 0.672 > Pika 0.612.



### Leader Board

| Categories    | SOTA    | Wan score |
| ------------- | ------- | --------- |
| ì¸ë¬¼ ë™ì¼ì„±   | Wan 2.1 | 0.81      |
| ë¬¼ë¦¬ ì •í•©ì„±   | Sora    | 0.78      |
| ì¹´ë©”ë¼ì›Œí¬    | Wan 2.1 | 0.83      |
| í”Œë¦¬ì»¤ ìµœì†Œí™” | Genâ€‘2   | 0.77      |
| OCR ì •í™•ë„    | Wan 2.1 | 0.85      |

### Ablation Studies

- **Flow Matching â†˜** DDPM êµì²´ â†’ FVD +7 â†—ï¸.
- **ì‹œê°„ ì„ë² ë”© ê³µìœ  MLP ì œê±°** â†’ CLIPâ€‘SIM â€‘0.3.



### Limitations & Error cases

1. **ê¸´ ì¥ë©´ ì „í™˜** ì‹œ ë™ì¼ ì¸ë¬¼ ì–¼êµ´ drift.
2. **ê³ ì£¼íŒŒ í…ìŠ¤ì²˜**(ì”ë””, ë¬¼ê²°)ì—ì„œ moire pattern.
3. 10 s ì´ìƒ ì‹œí€€ìŠ¤ â†’ í”Œë¦¬ì»¤ ì¦ê°€, ë©”ëª¨ë¦¬ í­ì¦.



# 5. Summary & Insights



#### Token Compression & 3D VQVAE

- í”„ë ˆì„ë‹¹ í† í° ìˆ˜ â†“ ~16x â†’ ì–´í…ì…˜ O(nÂ²) ë¶€ë‹´ ì™„í™”.

#### Sparse Global Attention

- Perâ€‘frame block sparse + periodic global token â†’ ì¥ë©´ ì¼ê´€ì„± â†‘.

#### Cascade Upsampling

- MSâ€‘VideoFusion êµ¬ì¡°: 128Â² â†’ 256Â² â†’ 512Â² â†’ 1080Â².

#### 3D Coherence Loss

- CLIPâ€‘VIT + Tâ€‘ViT dual lossë¡œ í”Œë¦¬ì»¤ FVD â€‘15 ë‹¬ì„± ì‚¬ë¡€.

#### ë©€í‹°ëª¨ë‹¬ ìœµí•© â†’ Scene Generation

- Text + Layout + Audio + Physics Prompt â†’ ì¸í„°ë™í‹°ë¸Œ ì”¬.



Wan 2.1ì€ **ì˜¤í”ˆì†ŒìŠ¤ ë¹„ë””ì˜¤ ìƒì„±ì˜ ì²´ê¸‰ì„ í•œ ë‹¨ê³„ ì˜¬ë¦° ëª¨ë¸**ì´ë‹¤. 3D Causal VAEì™€ Flow Matching Transformerë¼ëŠ” ë…ì°½ì  ì¡°í•©, ëŒ€ê·œëª¨ ë°ì´í„°ì…‹ ì»¤ë¦¬í˜ëŸ¼, íš¨ìœ¨ì ì¸ ë¶„ì‚° í•™ìŠµì´ ë§ë¬¼ë ¤ ë‚˜íƒ€ë‚œ ê²°ê³¼ì´ë‹¤. ì•ìœ¼ë¡œ í† í° ì••ì¶•, ìŠ¤íŒŒìŠ¤ ì–´í…ì…˜ ê¸°ë²•, ë©€í‹°ìŠ¤í…Œì´ì§€ ì—…ìƒ˜í”ŒëŸ¬ê°€ í•µì‹¬ ê³¼ì œê°€ ë  ê²ƒì´ë©°, ë¹„ë””ì˜¤ ìƒì„±ì€ ì¡°ë§Œê°„ **"í…ìŠ¤íŠ¸ â†’ ì˜í™”"**ë¡œ ì§„í™”í•  ê²ƒì´ë‹¤.

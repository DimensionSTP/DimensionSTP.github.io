---
layout: single
title:  "DeepSeek-V3 Review"
categories: Study-concept
tag: [DeepSeek, DeepSeek-V3, MLA, MoE, MTP, Mixed-precision, Hopper architecture]
toc: true
author_profile: false
sidebar:
    nav: "docs"
search: true
typora-root-url: ../
---





#  DeepSeek-V3 Review

ğŸ‘‰ğŸ»[ë…¼ë¬¸ ë§í¬](https://arxiv.org/abs/2412.19437 "DeepSeek V3") 

DeepSeek-V3ì— ëŒ€í•œ ë¦¬ë·°ëŠ” ì´ë¯¸ ë§ì´ ë‚˜ì™”ë‹¤. ë‹¨ìˆœí•œ ì„±ëŠ¥ ë¹„êµë‚˜ ë²¤ì¹˜ë§ˆí¬ ê²°ê³¼ë¥¼ ë‚˜ì—´í•˜ëŠ” ê²ƒì€ ì˜ë¯¸ê°€ ì—†ë‹¤ê³  ìƒê°í•œë‹¤.

ëŒ€ì‹ , ì´ë²ˆ ë¦¬ë·°ì—ì„œëŠ” **ìµœì ì˜ ì„±ëŠ¥ì„ ëŒì–´ë‚´ëŠ” íŠ¸ëœìŠ¤í¬ë¨¸ ì•„í‚¤í…ì²˜ì˜ ì„¤ê³„ì™€ íš¨ìœ¨ì ì¸ í•™ìŠµì„ ìœ„í•œ í˜¼í•© ì •ë°€ë„ í™œìš©**ì— ì§‘ì¤‘í•˜ë ¤ í•œë‹¤.

íŠ¹íˆ,

- ì „í†µì ì¸ ë””ì½”ë” ê¸°ë°˜ íŠ¸ëœìŠ¤í¬ë¨¸ ëª¨ë¸ì„ ì–´ë–¤ ê¸°ìˆ ë“¤ì„ ì ìš©í•´ì„œ **ê°œì„ ì„ ê±°ë“­**í•˜ì—¬ ì „ë°˜ì ì¸ íš¨ìœ¨ ë° ì„±ëŠ¥ì„ í–¥ìƒì‹œì¼°ëŠ”ì§€
- Nvidia Hopper Architectureë¥¼ ìµœëŒ€í•œ í™œìš©í•œ **FP8 mixed precision**ì´ ì–´ë–»ê²Œ ì„±ëŠ¥ì€ ìœ ì§€í•˜ë©´ì„œë„ ìì› ë° ì‹œê°„ì„ ì ˆê°ì‹œì¼°ëŠ”ì§€
- ê¸°íƒ€ í•™ìŠµ hyper-parameters

ì´ ì„¸ ê°€ì§€ í•µì‹¬ ìš”ì†Œë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ë¶„ì„í•´ë³´ë ¤ê³  í•œë‹¤. DeepSeek-V3ì˜ ì•„í‚¤í…ì²˜ì™€ í•™ìŠµ ê¸°ë²•ì´ ê¸°ì¡´ ëª¨ë¸ê³¼ ì–´ë–¤ ì°¨ë³„ì ì„ ê°€ì§€ëŠ”ì§€ ì‚´í´ë³´ì.



# Architectures

- DeepSeek V3ì˜ ì•„í‚¤í…ì²˜ëŠ” ê¸°ì¡´ì˜ ì „í†µì ì¸ ë””ì½”ë” ê¸°ë°˜ íŠ¸ëœìŠ¤í¬ë¨¸ ëª¨ë¸ ëŒ€ë¹„ 3ê°€ì§€ê°€ ë‹¤ë¦„
  - MLA
    - MLAëŠ” ë”¥ì‹œí¬ì˜ ë…ìì  êµ¬ì¡°
  - MoE
    - MoEëŠ” ë§ì´ ì¡´ì¬í•´ì™“ìœ¼ë‚˜ ë”¥ì‹œí¬ë§Œì˜ ì•„ì´ë””ì–´ ì²¨ê°€(auxiliary-loss free strategy, default top p)
  - MTP
    - MTPëŠ” ê¸°ì¡´ì´ë‚˜ ë©”ë‘ì‚¬ì™€ ê°™ì´ LM headë¥¼ ë‚˜ëˆ„ëŠ”ê²Œ ì•„ë‹ˆë¼ lm headëŠ” ê³µìœ , íŠ¸ëœìŠ¤í¬ë¨¸ ë¸”ë¡ì— ì¬ê·€ì ìœ¼ë¡œ íƒœìš°ëŠ” ë°©ì‹
    - ì¶”ë¡  ëª¨ë¸ë§ ì½”ë“œì—ëŠ” êµ¬í˜„ë˜ì–´ìˆì§€ ì•Šì•„ì„œ êµ¬ì²´ì ìœ¼ë¡œ ì•Œ ìˆ˜ëŠ” ì—†ìŒ

ì‹œì‘





## Multi-head Latent Attention(MLA)

+ ë”¥ì‹œí¬ë§Œì˜ ë…ìì  ì•„í‚¤í…ì²˜
+ Q, K, Vë¥¼ ì²˜ìŒë¶€í„° lora ì´ìš©
+ K, Vë¥¼ 1ê°œì˜ projectionì—ì„œ ë½‘ìŒ
+ ropeì™€ nopeë¡œ ë‚˜ëˆ”
+ GQA, MQA ë‘˜ ë‹¤ í™œìš©(k head dim = 1 -> rope or nope)
+ ë¼ë§ˆ ì–´í…ì…˜ ì½”ë“œ ìº¡ì²˜ ì¶”ê°€
+ MLA ì½”ë“œ ìº¡ì²˜ ì¶”ê°€
+ ë¼ë§ˆ ì–´í…ì…˜ í”¼ê·œì–´ ì¶”ê°€
+ MLA í”¼ê·œì–´ ì¶”ê°€

ì‹œì‘



![MLA](/images/2025-02-19-DeepSeek-V3/deepseek-mla.png){: .align-center}





## Mixture of Experts(MoE)

- MoEëŠ” ê¸°ì¡´ì—ë„ ìˆì—ˆìŒ
- í•˜ì§€ë§Œ deepseekëŠ” ì¶”ê°€ì ì¸ ì•„ì´ë””ì–´ ê°€ë¯¸
- auxiliary-loss free strategy
- default top p
- ì´ë ‡ê²Œ í–ˆì„ ë•Œ ì¥ì 
- MoE í”¼ê·œì–´ ì¶”ê°€
- deepseek MoE ë…¼ë¬¸ ìˆ˜ì‹ ìº¡ì²˜ ì¶”ê°€
- deepseek MoE ì½”ë“œ ìº¡ì²˜ ì¶”ê°€

ì‹œì‘



ğŸ‘‰ğŸ»[DeepSeek MoE ë…¼ë¬¸ ë§í¬](https://arxiv.org/pdf/2401.06066 "DeepSeek MoE") 



![MoE](/images/2025-02-19-DeepSeek-V3/deepseek-moe.png){: .align-center}





## Multi-Token Prediction(MTP)

+ MTPëŠ” train ë‹¨ê³„ì—ì„œ ë§ì´ ì“°ëŠ” ë°©ë²•
+ ê¸°ì¡´ MTP ë°©ë²•ë¡ ë“¤ ì†Œê°œ
+ ê¸°ì¡´ MTP í”¼ê·œì–´ ìº¡ì²˜ ì¶”ê°€
+ deepseekì˜ MTP ì°¨ë³„ì„± ì†Œê°œ
+ deepseek MTP í”¼ê·œì–´ ìº¡ì²˜ ì¶”ê°€
+ ì´ë ‡ê²Œ í•  ë•Œ ì¥ì  ì„¤ëª…
+ modeling deepseekëŠ” ì¶”ë¡  ëª¨ë¸ êµ¬ì„±ì´ë¼ trainì€ ì•Œ ìˆ˜ ì—†ìŒ, ê·¸ë˜ì„œ êµ¬ì²´ì ì¸ êµ¬í˜„ì€ ì•Œ ìˆ˜ ì—†ìŒ

ì‹œì‘



![MTP](/images/2025-02-19-DeepSeek-V3/deepseek-mtp.png){: .align-center}





# Mixed Precision

+ deepseekëŠ” ëŒ€ì¤‘êµ­ gpu ê·œì œë¡œ H100ì˜ ë‹¤ìš´ê·¸ë ˆì´ë“œ ë²„ì „ì¸ H800ë§Œì„ ì‚¬ìš©
+ H100 vs H800 ë¹„êµ ìº¡ì²˜ ì¶”ê°€
+ ê·¸ëŸ¬ë‚˜ H800ë„ hopper ì•„í‚¤í…ì²˜ì„
+ ë”¥ì‹œí¬ëŠ” hopper ì•„í‚¤í…ì²˜ì˜ íŠ¹ì§•ì¸ fp8 í˜¼í•©ì •ë°€ë„ ìµœì í™” ë°©ì‹ì„ ìµœëŒ€í•œ í™œìš©

ì‹œì‘





## FP8 mixed precision

+ deepseekëŠ” ëª¨ë¸ í•™ìŠµ, ì¤‘ê°„ ì €ì¥, ìµœì¢… ì €ì¥ì— fp8, bf16, fp32 ëª¨ë‘ í™œìš©í•¨
+ ì´ì „ ampere ì•„í‚¤í…ì²˜ bf16 í˜¼í•© ì •ë°€ë„ ì„¤ëª…
+ ampere ì•„í‚¤í…í„° ì¥ì  ìº¡ì²˜ ì¶”ê°€
+ ê¸°ì¡´ mixed precision ë°©ì‹ ì„¤ëª…
+ ê¸°ì¡´ mixed precision ë°©ì‹ ìº¡ì²˜ ì¶”ê°€
+ blackwell ì´ì „ ì§€ê¸ˆ ê°€ì¥ ëŒ€ì¤‘ì ì¸ hopper ì•„í‚¤í…ì²˜ì™€ fp8 í˜¼í•© ì •ë°€ë„ ì„¤ëª…
+ hopper ì•„í‚¤í…ì²˜ ì¥ì  ìº¡ì²˜ ì¶”ê°€
+ fp8 mixed precision ë°©ì‹ ì„¤ëª…
+ deepseek mixed precision ë°©ì‹ ìº¡ì²˜ ì¶”ê°€(ê¸°ì¡´ê³¼ ë¹„êµ í•˜ëŠ” ë‚´ìš© ì¶”ê°€ í¸ì§‘í•  ê²ƒ)
+ ê·¸ë˜ì„œ íš¨ìœ¨ì ìœ¼ë¡œ í•™ìŠµì„ ì´ë¤„ëƒ„

ì‹œì‘



![mixed-precision](/images/2025-02-19-DeepSeek-V3/mixed-precision.png){: .align-center}



![backprop-0](/images/2025-02-19-DeepSeek-V3/backprop-0.png){: .align-center}



![backprop-1](/images/2025-02-19-DeepSeek-V3/backprop-1.png){: .align-center}



![backprop-2](/images/2025-02-19-DeepSeek-V3/backprop-2.png){: .align-center}



![backprop-3](/images/2025-02-19-DeepSeek-V3/backprop-3.png){: .align-center}



![backprop-4](/images/2025-02-19-DeepSeek-V3/backprop-4.png){: .align-center}



![backprop-5](/images/2025-02-19-DeepSeek-V3/backprop-5.png){: .align-center}



![backprop-6](/images/2025-02-19-DeepSeek-V3/backprop-6.png){: .align-center}



![backprop-7](/images/2025-02-19-DeepSeek-V3/backprop-7.png){: .align-center}



![deepseek-fp8](/images/2025-02-19-DeepSeek-V3/deepseek-fp8.png){: .align-center}



# Hyper-Parameters

+ deepseekì˜ ë‹¨ê³„ë³„ ëª¨ë¸ íŠ¸ë ˆì´ë‹ í•˜ì´í¼ íŒŒë¼ë¯¸í„° ì •ë¦¬
+ llamaì˜ ë‹¨ê³„ë³„ ëª¨ë¸ íŠ¸ë ˆì´ë‹ í•˜ì´í¼ íŒŒë¼ë¯¸í„°ì™€ ë¹„êµ
+ ì¸ì‚¬ì´íŠ¸ ì¶”ê°€

ì‹œì‘



![deepseek-pretrain-hparams](/images/2025-02-19-DeepSeek-V3/deepseek-pretrain-hparams.png){: .align-center}



![deepseek-long-context-hparams](/images/2025-02-19-DeepSeek-V3/deepseek-long-context-hparams.png){: .align-center}



![deepseek-sft-hparams](/images/2025-02-19-DeepSeek-V3/deepseek-sft-hparams.png){: .align-center}





# í›„ê¸°

+ deepseek v3ë¥¼ ë¦¬ë·°í•˜ë©° ì ì€ ìì› ë‚´ì—ì„œ ìµœëŒ€í•œ íš¨ìœ¨ì„ ë½‘ì•„ë‚´ë ¤ë‹¤ë³´ë‹ˆ ë†€ë¼ìš´ ì—°êµ¬ ì„±ê³¼ê°€ ë‚˜íƒ€ë‚¨
+ ê¸°ì¡´ì˜ ì¡ê¸°ìˆ ë“¤ì„ ëª¨ë‘ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ë„˜ì–´ì„œ ë°œì „ì‹œí‚´
+ ë¬¼ë¡  ë°ì´í„°ì— ëŒ€í•œ ì´ìŠˆëŠ” ìˆì§€ë§Œ ê¸°ìˆ ì˜ ë°œì „ì— ê¸°ì—¬í•œ ê²ƒì€ ë¬´ì‹œë˜ì–´ì„  ì•ˆë¨
+ í•˜ë‚˜í•˜ë‚˜ ì‘ì€ ì¡ê¸°ìˆ ë“¤ì˜ ì ìš©ìœ¼ë¡œ ì¸í•´ í° ì‚°ì„ ë§Œë“¤ì–´ëƒ„
+ ê¸°ìˆ ë„ ì˜ˆìˆ ë„ í° ìë³¸ì—ì„œ ê·œëª¨ì  ë°œì „ì„ ì´ë¤„ë‚¸ë‹¤ë©´, ê²°í•ì—ì„œëŠ” í˜ì‹ ì„ ì´ë¤„ë‚¸ë‹¤

ì‹œì‘

